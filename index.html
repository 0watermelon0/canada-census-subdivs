<!DOCTYPE html>
<meta charset="utf-8">
<style>


.land {
  fill: #fff;
}

.border {
  fill: none;
  stroke: #bbb;
  stroke-linejoin: round;
  stroke-linecap: round;
}
    
path {
/*  fill: #ddd;*/
    fill: none;
  stroke: #fff;
  stroke-linejoin: round;
  stroke-linecap: round;
}
    
.bubble {
  fill-opacity: .5;
    fill: #900;
  stroke: #fff;
  stroke-width: .5px;
}

</style>
<body>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://d3js.org/topojson.v1.min.js"></script>
<script>

var width = 960,
    height = 650;

var proj = d3.geo.albers()
        .center([0,62])
        .rotate([92.5,0])
        .parallels([49,60])
        .scale(950)
        .translate([width/2, height/2]);

var path = d3.geo.path()
    .projection(proj);

var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height)
    .attr("class","back");

d3.json("can.json", function(error, can) {
  if (error) return console.error(error);

    console.log(can);
        
    svg.append("path")
        .datum(topojson.feature(can,can.objects.nation))
        .attr("class","land")
        .attr("d",path);
    
    svg.append("path")
        .datum(topojson.mesh(can,can.objects.nation, function(a,b) { return a!==b || a===b; }))
        .attr("class","border")
        .attr("d",path);
  
/*    svg.append("path")
        .datum(topojson.mesh(can,can.objects.provs, function(a,b) { return a!==b || a===b; }))
        .attr("class","border border--provs")
        .attr("d",path);
  */  
    var radius = d3.scale.sqrt()
        .domain([0,3e6])
        .range([0,25]);
        
    svg.append("g")
        .attr("class","bubble")
        .selectAll("circle")
        .data(topojson.feature(can,can.objects.subdivs).features
        .sort(function(a, b) { return b.properties.total - a.properties.total; }))
        .enter()
        .append("circle")
        .attr("transform",function(d) { 
            return "translate(" + path.centroid(d) + ")";
        })
        .attr("r",function(d) {
            return radius(d.properties.total);
        });
});    
</script>
</body>    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    